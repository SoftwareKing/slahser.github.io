对于网络相关我远没有论坛上那些人专业,不知道他们货比三家的劲头儿是哪儿来的.. 

> 论坛上一是买vps,二是搞路由器,这两块我一看到就头疼. 

手头有了一份奇怪的需求,所以随手买个vps搞个ss给集群用.  

很久以前我写过[osx上的Surge与SS](http://www.slahser.com/2016/03/31/osx上的Surge与SS/)和[日志监控平台优化-启用Supervisor](http://www.slahser.com/2016/04/27/日志监控平台优化-启用Supervisor/),所以这篇新东西也不会太多. 

- 搬瓦工购买
- shadowsocks开启
- net-speeder
- supervisor

## 基本 

购买不提,配置不提. 

> 还是提一下,我买的是10G PROMO V3 - PHOENIX AZ. 

进入kiwivm调密码/hostname/安装ss/修改ss加密算法/修改ss密码. 

## net-speeder 

这里是[地址](https://github.com/snooda/net-speeder)

双倍发包防止丢包的软件,双倍耗费流量. 

> 我这边凤凰城的搬瓦工实测是ping稍微降低,上传下载速度4倍左右. 

默认安装的centos6下: 

```
wget https://github.com/snooda/net-speeder/archive/master.zip
unzip master.zip

wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
rpm -ivh epel-release-6-8.noarch.rpm
yum install libnet libpcap libnet-devel libpcap-devel gcc

cd net-speeder-master
sh build.sh -DCOOKED
``` 

而后编辑supervisor脚本: 

```
[program:netspeeder]
command=/net-speeder-master/net_speeder
user = root       ; 用哪个用户启动
autostart = true     ; 在 supervisord 启动的时候也自动启动
startsecs = 5        ; 启动 5 秒后没有异常退出，就当作已经正常启动了
autorestart = true   ; 程序异常退出后自动重启
startretries = 3     ; 启动失败自动重试次数，默认是 3
``` 

而后: 

```
supervisord -c /etc/supervisord.conf
supervisorctl -c /etc/supervisord.conf 
``` 

## 客户端  

尽管版本很老,但还是用着吧

```
agt-get install shadowsocks

[program:ss]
command=sslocal -c /etc/shadowsocks.json
autostart = true     
startsecs = 5        
autorestart = true   
startretries = 3     
user = root 
``` 

那么使用以下命令即可随时查看ss情况: 

```shell
ansible pis -m command -a 'supervisorctl status ss'
``` 

done. 

